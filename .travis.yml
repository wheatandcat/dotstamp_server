language: go
go:
  - 1.7.x
sudo: required
before_install:
  - curl --silent --location https://github.com/groonga/groonga/raw/master/data/travis/setup.sh | sh
  - sudo apt-get -qq update
  - sudo apt-get install  software-properties-common -y
  - sudo add-apt-repository ppa:mc3man/trusty-media -y
  - sudo apt-get install ffmpeg -y
  - sudo apt-get install lame -y
  - sudo apt-get install open-jtalk -y
  - sudo apt-get install open-jtalk-mecab-naist-jdic hts-voice-nitech-jp-atr503-m001 -y 
addons:
  mariadb: '10.0'
install:
  - go get github.com/Masterminds/glide
  - go get github.com/golang/lint/golint
  - go get bitbucket.org/liamstask/goose/cmd/goose
before_script:
  - mysql -uroot -e "create database stamp_test"
  - mysql -uroot -e "INSTALL PLUGIN Mroonga SONAME 'ha_mroonga.so';"
  - goose -env test up
script:
  - glide install
  - go build main.go
  - go test -p 1 ./models
  - go test -p 1 ./tests/controllers/*
