---
language: go
go:
  - 1.7.x
sudo: required
before_install:
  - curl --silent --location https://github.com/groonga/groonga/raw/master/data/travis/setup.sh | sh
addons:
  mariadb: '10.2.6'
install:
  - go get github.com/Masterminds/glide
  - go get github.com/golang/lint/golint
  - go get bitbucket.org/liamstask/goose/cmd/goose
before_script:
  - mysql -uroot -e "create database stamp_test"
  - mysql -uroot -e "INSTALL PLUGIN Mroonga SONAME 'ha_mroonga.so';"
  - mysql -uroot -e "CREATE FUNCTION mroonga_snippet RETURNS STRING SONAME 'ha_mroonga.so';"
  - mysql -uroot -e "CREATE FUNCTION mroonga_command RETURNS STRING SONAME 'ha_mroonga.so';"
  - mysql -uroot -e "CREATE FUNCTION mroonga_escape RETURNS STRING SONAME 'ha_mroonga.so';"
  - goose -env test up
script:
  - glide install
  - go build main.go
